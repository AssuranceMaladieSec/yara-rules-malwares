import "pe"

rule lilith_detection {
    meta:
		description = "Detection rule for ransomware Lilith"
        md5 = "b7a182db3ba75e737f75bda1bc76331a"
        sha1 = "cf0fe28214ad4106c48ec5867327319eaa82b3c3"
		sha256 = "f3caa040efb298878b99f883a898f76d92554e07a8958e90ff70e7ff3cfabdf5"
        author = "Alice Climent-Pommeret @Assurance Maladie Security Team"
    
    strings:
		$lilith_extension = ".lilith" wide
		$tor = "Tor Browser" wide
		$ransom_note = "Restore_Your_Files.txt" wide
		$notepad = "notepad.exe" wide
		$beng = "beng50.exe" wide
		$driveW = "W:\\" wide
		$driveY = "Y:\\" wide
		$driveZ = "Z:\\" wide
		$driveX = "X:\\" wide
		$public_key = "ecdh_pub_k.bin" wide
	
    condition:
		pe.is_pe
		and filesize < 300KB
		and for any section in pe.sections : ( section.name == ".gehcont" ) 
		and for any section in pe.sections : ( section.name == ".gfids" )
		and all of them
}

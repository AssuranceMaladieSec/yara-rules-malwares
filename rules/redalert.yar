import "elf"

rule red_alert_detection {
	meta:
		description = "Detection rule for ransomware Red Alert"
		date = "07/08/2022"
		version = "1.0"
		filetype = "ELF 64-bit LSB executable, x86-64"
		md5 = "f2fa9a3ce883a7f5b43ba5c9ff7bdf75"
		sha1 = "da6a7e9d39f6a9c802bbd1ce60909de2b6e2a2aa"
		sha256 = "039e1765de1cdec65ad5e49266ab794f8e5642adb0bdeb78d8c0b77e8b34ae09"
		author = "Alice Climent-Pommeret @Assurance Maladie Security Team"
	strings:
		$generic_name = "N13V" ascii
		$generic_extension = ".crypt658" ascii 
		$generic_redalert_id = "REDALERT UNIQUE IDENTIFIER START" ascii
		$typo_penetrated = "Your network was penterated" ascii 
		$typo_reversible = "Encryption is reverssible process" ascii 
		$typo_situation = "seriousness of this sutation" ascii 
	condition:
		elf.type == elf.ET_EXEC
		and filesize < 400KB
		and for any symbol in elf.symtab : ( symbol.name == "dir_walk" ) 
		and for any symbol in elf.symtab : ( symbol.name == "createReqFile" ) 
		and for any symbol in elf.symtab : ( symbol.name == "isVmFile" ) 
		and for any symbol in elf.symtab : ( symbol.name == "preRun" ) 
		and 2 of ($generic_*) 
		and 2 of ($typo_*) 
}
